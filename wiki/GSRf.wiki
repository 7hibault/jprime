#summary Description and instructions for GSRf.

= JPrIME-GSRf =

== CONTENTS ==
  # [GSRf#INTRODUCTION]
  # [GSRf#INPUT]
  # [GSRf#OUTPUT]
  # [GSRf#RUNNING]
  # [GSRf#ANALYSIS]

== INTRODUCTION ==

JPrIME-GSRf is a phylogenetic application for reconciling an unknown guest tree and a known host tree by means of duplication events and loss events. Typically, the guest tree corresponds to a gene tree, and the host tree corresponds to a species tree. JPrIME-GSRf relies on Bayesian inference using an MCMC framework. Thus, it will yield a posterior distribution of guest tree topologies and remaining parameters.

*Input:*
  * a file with a dated host tree.
  * a file with multialignment of guest tree leaf sequences.
  * a file with a simple map relating the guest tree leaves to host tree leaves.

*Output:*
  * a file with samples drawn from the posterior distribution.

== INPUT ==
 
=== Host tree ===
Obtain a dated species tree in Newick format. The divergence times may be specified as branch lengths, e.g.:
{{{
((A:0.4,B:0.4):0.6,C:1.0):0.5;
}}}
Alternatively, one can specify absolute times using special formatting:
{{{
((A[&&PRIME NT=0.0],B[&&PRIME NT=0.0])[&&PRIME NT=0.4],C[&&PRIME NT=0.0])[&&PRIME NT=1.0][&&PRIME TT=0.5];
}}}
The host tree must be ultrametric, with time 0 at the leaves and >0 at the root, and a "stem" of length >0 (in the above example this was set to 0.5). The scale of the dates can be any unit: *they will be rescaled internally prior to running so that the root time is 1.0, and the output will refer to this scaling*, and not the original.

A good resource for divergence times is [http://www.timetree.org]. If you cannot find references to reliable divergence times, you will need to date the tree yourself. Typically, this is achieved by obtaining a set of "core" gene families (e.g. monocopy putative orthologs), aligning these, then feeding the concatenated super-alignment into a program which estimates divergence times. For acquiring core genes for microbial datasets [http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0024704 this article] may be of help. For dating, consider e.g. [http://www.biomedcentral.com/1471-2148/8/77 MAP-DP], [http://www.phylobayes.org PhyloBayes] or [http://loco.biosci.arizona.edu/r8s r8s].

=== Multialignment ===
The multialignments can be computed with any suitable program (MAFFT, MUSCLE, CLUSTAL, etc.), but should be provided on the Fasta format, e.g. for the example above:
{{{
>a1
MTKKELIKSIAEKNKTSITQTEEFYNSFENAIIKAI
>a2
MTKKELIKSIAEKNKTSITQTEEFYNSFENAIIKAI
>b1
MNKKELIKSIAEVNKTSITQTEEFYNSFENALIKAI
>c1
MNKKELIKSIAEVNKTSITQTEEFYNSFENALIKAI
>c2
MNKKELIKSIAEVNKTSITQTEEFYNSFENALIKAI
}}}
Please consider clearing ambiguous positions from the alignment using e.g. [http://trimal.cgenomics.org trimAl] or [http://molevol.cmima.csic.es/castresana/Gblocks.html Gblocks] before feeding it into JPrIME-GSRf.

=== Mapping ===
The guest-to-host leaf map is straighforward, e.g., for the example above:
{{{
a1   A
a2   A
b1   B
c1   C
c2   C
}}}

== OUTPUT ==
Output normally consists of two files, e.g.:
  * {{{myoutput.info}}}, containing general pre- and post-run information.
  * {{{myoutput.mcmc}}}, containing tab-delimited samples drawn from the posterior distribution.
The latter will look something like:
{{{
N       L         Param1     Param2   Param3
0       1.5e-64   1.0        0.1      0.1
200     2.4e-32   0.56       0.23     0.43
400     1.5e-30   0.51       0.18     0.52
...
}}}

== RUNNING ==
Typically, you would start it by running e.g.:
{{{
java -cp mypath/jprime-0.0.0.jar se.cbb.jprime.apps.gsrf
}}}
where the path and version number of course refer to your current setup.

== ANALYSIS ==
To be announced. However, consider using CRAN R in general, and, for convergence in particular, its [http://cran.r-project.org/web/packages/coda/index.html CODA package].